(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(){t=function(){return r};var r={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function f(e,t,r,n){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),c=new O(n||[]);return i(a,"_invoke",{value:S(e,r,c)}),a}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}r.wrap=f;var h={};function p(){}function y(){}function v(){}var m={};l(m,c,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(x([])));b&&b!==n&&o.call(b,c)&&(m=b);var w=v.prototype=p.prototype=Object.create(m);function P(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function F(t,r){function n(i,a,c,u){var s=d(t[i],t,a);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==e(f)&&o.call(f,"__await")?r.resolve(f.__await).then((function(e){n("next",e,c,u)}),(function(e){n("throw",e,c,u)})):r.resolve(f).then((function(e){l.value=e,c(l)}),(function(e){return n("throw",e,c,u)}))}u(s.arg)}var a;i(this,"_invoke",{value:function(e,t){function o(){return new r((function(r,o){n(e,t,r,o)}))}return a=a?a.then(o,o):o()}})}function S(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return C()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=E(a,r);if(c){if(c===h)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=d(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function E(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var o=d(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,h;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function x(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(o.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:C}}function C(){return{value:void 0,done:!0}}return y.prototype=v,i(w,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:y,configurable:!0}),y.displayName=l(v,s,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,s,"GeneratorFunction")),e.prototype=Object.create(w),e},r.awrap=function(e){return{__await:e}},P(F.prototype),l(F.prototype,u,(function(){return this})),r.AsyncIterator=F,r.async=function(e,t,n,o,i){void 0===i&&(i=Promise);var a=new F(f(e,t,n,o),i);return r.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(w),l(w,s,"Generator"),l(w,c,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},r.values=x,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},r}function r(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function n(t,r){for(var n=0;n<r.length;n++){var o=r[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(i=o.key,a=void 0,a=function(t,r){if("object"!==e(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,r||"default");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(i,"string"),"symbol"===e(a)?a:String(a)),o)}var i,a}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.form=t,this.jQueryForm=jQuery(t),this.ajaxurl=Give.fn.getGlobalVar("ajaxurl"),this.setupProperties()}var o,i,a,c,u;return o=e,i=[{key:"setupProperties",value:function(){}},{key:"boot",value:function(){this.renderPaymentMethodOption()}},{key:"renderPaymentMethodOption",value:function(){}},{key:"showError",value:function(e){e.hasOwnProperty("details")?C.addErrors(this.jQueryForm,Give.form.fn.getErrorHTML([{message:e.details[0].description}])):C.addErrors(this.jQueryForm,e)}},{key:"isInTestMode",value:function(){return"1"===Give.fn.getGlobalVar("is_test_mode")}},{key:"displayErrorMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Give.form.fn.getErrorHTML([{message:window.givePayPalCommerce.genericDonorErrorMessage}]);(t||this.isInTestMode())&&(r=e),this.showError(r)}},{key:"isProcessingEventForForm",value:function(e){return e===this.form.getAttribute("id")&&C.isPayPalCommerceSelected(this.jQueryForm)}},{key:"createOrderHandler",value:(c=t().mark((function e(r,n){var o,i;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Give.form.fn.removeErrors(this.jQueryForm),e.next=3,fetch("".concat(this.ajaxurl,"?action=give_paypal_commerce_create_order"),{method:"POST",body:C.getFormDataWithoutGiveActionField(this.form)});case 3:return o=e.sent,e.next=6,o.json();case 6:if((i=e.sent).success){e.next=9;break}throw i.data.error;case 9:return e.abrupt("return",i.data.id);case 10:case"end":return e.stop()}}),e,this)})),u=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=c.apply(e,t);function a(e){r(i,n,o,a,u,"next",e)}function u(e){r(i,n,o,a,u,"throw",e)}a(void 0)}))},function(e,t){return u.apply(this,arguments)})}],i&&n(o.prototype,i),a&&n(o,a),Object.defineProperty(o,"prototype",{writable:!1}),e}();const i=o;function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===a(i)?i:String(i)),n)}var o,i}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}const f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(i,e);var t,r,n,o=s(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.apply(this,arguments)}return t=i,n=[{key:"canShow",value:function(e){return _.canShow()&&C.isRecurringDonation(e)&&["US","AU"].includes(window.givePayPalCommerce.accountCountry)}}],(r=[{key:"setupProperties",value:function(){this.ccFieldsContainer=this.form.querySelector('[id^="give_cc_fields-"]'),this.cardFields=this.getCardFields(),this.recurringChoiceHiddenField=this.form.querySelector('input[name="_give_is_donation_recurring"]'),(this.separator=this.ccFieldsContainer.querySelector(".separator-with-text"))||(this.separator=this.cardFields.number.el?this.cardFields.number.el.parentElement.insertAdjacentElement("beforebegin",this.separatorHtml()):null)}},{key:"renderPaymentMethodOption",value:function(){this.toggleFields()}},{key:"getCardFields",value:function(){return{number:{el:this.form.querySelector('input[name="card_number"]')},cvv:{el:this.form.querySelector('input[name="card_cvc"]')},expirationDate:{el:this.form.querySelector('input[name="card_expiry"]')}}}},{key:"toggleFields",value:function(){var e=i.canShow(this.form)?"block":"none";for(var t in this.cardFields)this.cardFields[t].el.style.display=e,this.cardFields[t].el.disabled="none"===e}},{key:"removeFields",value:function(){for(var e in this.cardFields)this.cardFields[e].el&&this.cardFields[e].el.parentElement.remove();var t=this.form.querySelector('input[name="card_name"]');t&&t.parentElement.remove(),this.separator&&this.separator.remove()}},{key:"separatorHtml",value:function(){var e=document.createElement("div");return e.setAttribute("class","separator-with-text"),e.innerHTML='<div class="dashed-line"></div><div class="label">'.concat(givePayPalCommerce.separatorLabel,'</div><div class="dashed-line"></div>'),e}}])&&c(t.prototype,r),n&&c(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(i);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){return(t=w(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v(){v=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function s(e,t,r,o){var i=t&&t.prototype instanceof h?t:h,a=Object.create(i.prototype),c=new O(o||[]);return n(a,"_invoke",{value:S(e,r,c)}),a}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var f={};function h(){}function p(){}function y(){}var m={};u(m,i,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(x([])));b&&b!==t&&r.call(b,i)&&(m=b);var w=y.prototype=h.prototype=Object.create(m);function P(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function F(e,t){function o(n,i,a,c){var u=l(e[n],e,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==d(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){o("next",e,a,c)}),(function(e){o("throw",e,a,c)})):t.resolve(f).then((function(e){s.value=e,a(s)}),(function(e){return o("throw",e,a,c)}))}c(u.arg)}var i;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){o(e,r,t,n)}))}return i=i?i.then(n,n):n()}})}function S(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return C()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=E(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=l(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function E(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=l(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,f;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function x(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:C}}function C(){return{value:void 0,done:!0}}return p.prototype=y,n(w,"constructor",{value:y,configurable:!0}),n(y,"constructor",{value:p,configurable:!0}),p.displayName=u(y,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,u(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},P(F.prototype),u(F.prototype,a,(function(){return this})),e.AsyncIterator=F,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new F(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},P(w),u(w,c,"Generator"),u(w,i,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=x,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function m(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function g(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){m(i,n,o,a,c,"next",e)}function c(e){m(i,n,o,a,c,"throw",e)}a(void 0)}))}}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w(n.key),n)}}function w(e){var t=function(e,t){if("object"!==d(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===d(t)?t:String(t)}function P(e,t){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},P(e,t)}function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=S(e);if(t){var o=S(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}var E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}(s,e);var t,r,n,o,i,a,c,u=F(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=u.call(this,e.form)).customCardFields=e,t.setFocusStyle(),t}return t=s,r=[{key:"setupProperties",value:function(){this.cardFields={},this.hostedCardFieldsContainers={},this.hostedFieldContainerStyleProperties=["height"],this.hostedInputFieldStyleProperties=["color","direction","font-size","letter-spacing","line-height"],this.hostedFocusedInputFieldStyleProperties=["color","border-left-color"],this.hostedInputFieldPlaceholderStyleProperties=["color"],this.styles={container:{},input:{},"input:focus":{},"input:placeholder":{}}}},{key:"renderPaymentMethodOption",value:(c=g(v().mark((function e(){var t,r,n,o,i,a,c=this;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setupContainerForHostedCardFields(),this.applyStyleToContainer(),t="submit.".concat(this.form.getAttribute("id")),r=this.createOrderHandler.bind(this),e.next=6,this.getComputedInputFieldForHostedField();case 6:return n=e.sent,o=this.getPayPalHostedCardFields(),e.next=10,paypal.HostedFields.render({createOrder:r,styles:n,fields:o}).catch((function(e){c.displayErrorMessage(e)}));case 10:i=e.sent,a=this.onSubmitHandlerForDonationForm.bind(this),this.addEventToHostedFields(i),this.jQueryForm.off(t).on(t,{hostedCardFields:i},a);case 14:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"setupContainerForHostedCardFields",value:function(){var e=this.customCardFields.cardFields,t="";for(var r in e){var n=document.createElement("div");t=e[r].el.getAttribute("name");var o="give-".concat(e[r].el.getAttribute("id")),i=void 0;(i=this.form.querySelector("#".concat(o)))?(i.innerHTML="",this.hostedCardFieldsContainers[this.getFieldTypeByFieldName(t)]=i):(n.setAttribute("id",o),n.setAttribute("class","give-paypal-commerce-cc-field give-input-field-wrapper"),this.hostedCardFieldsContainers[this.getFieldTypeByFieldName(t)]=e[r].el.parentElement.appendChild(n))}this.toggleFields()}},{key:"getPayPalHostedCardFields",value:function(){return{number:{selector:"#".concat(this.hostedCardFieldsContainers.number.getAttribute("id")),placeholder:givePayPalCommerce.cardFieldPlaceholders.cardNumber},cvv:{selector:"#".concat(this.hostedCardFieldsContainers.cvv.getAttribute("id")),placeholder:givePayPalCommerce.cardFieldPlaceholders.cardCvc},expirationDate:{selector:"#".concat(this.hostedCardFieldsContainers.expirationDate.getAttribute("id")),placeholder:givePayPalCommerce.cardFieldPlaceholders.expirationDate}}}},{key:"approvePayment",value:(a=g(v().mark((function e(t){var r;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this.ajaxurl,"?action=give_paypal_commerce_approve_order&order=")+t,{method:"POST",body:C.getFormDataWithoutGiveActionField(this.form)});case 2:return r=e.sent,e.next=5,r.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"getComputedInputFieldForHostedField",value:function(){return{input:p(p({},this.styles.input),givePayPalCommerce.hostedCardFieldStyles.input),":focus":p({color:this.styles["input:focus"].color},givePayPalCommerce.hostedCardFieldStyles[":focus"]),":placeholder":p({color:this.styles["input:placeholder"].color},givePayPalCommerce.hostedCardFieldStyles[":placeholder"])}}},{key:"onSubmitHandlerForDonationForm",value:(i=g(v().mark((function e(t){var r,n,o,i;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C.isPayPalCommerceSelected(this.jQueryForm)){e.next=2;break}return e.abrupt("return",!0);case 2:if(!C.isRecurringDonation(this.form)){e.next=6;break}return Give.form.fn.showProcessingState(window.givePayPalCommerce.textForOverlayScreen),this.submitDonationForm(),e.abrupt("return");case 6:return r=this.hostedFieldOnSubmitErrorHandler.bind(this),t.preventDefault(),Give.form.fn.removeErrors(this.jQueryForm),n=t.data.hostedCardFields,o=this.getExtraCardDetails.bind(this),e.next=13,n.submit(p({contingencies:["SCA_WHEN_REQUIRED"]},o)).catch(r);case 13:if(i=e.sent){e.next=16;break}return e.abrupt("return",!1);case 16:if(!this.canThreeDsAuthorizeCard(i)||this.IsCardThreeDsAuthorized(i)){e.next=19;break}return Give.form.fn.addErrorsAndResetDonationButton(this.jQueryForm,Give.form.fn.getErrorHTML([{message:givePayPalCommerce.threeDsCardAuthenticationFailedNotice}])),e.abrupt("return",!1);case 19:return e.next=21,this.onApproveHandler(i);case 21:return e.abrupt("return",!1);case 22:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"onApproveHandler",value:(o=g(v().mark((function e(t){var r;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Give.form.fn.showProcessingState(window.givePayPalCommerce.textForOverlayScreen),e.next=3,this.approvePayment(t.orderId);case 3:if((r=e.sent).success){e.next=7;break}return this.hostedFieldOnSubmitErrorHandler(r.data.error),e.abrupt("return");case 7:return e.next=9,C.addFieldToForm(this.form,r.data.order.id,"payPalOrderId");case 9:this.submitDonationForm();case 10:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"getExtraCardDetails",value:function(){return{cardholderName:this.form.getElementById("#card_name").value}}},{key:"addEventToHostedFields",value:function(e){var t=this;e.on("focus",(function(e){t.hostedCardFieldsContainers[e.emittedBy].classList.add("has-focus")})),e.on("blur",(function(e){t.hostedCardFieldsContainers[e.emittedBy].classList.remove("has-focus")}))}},{key:"applyStyleToContainer",value:function(){this.computedStyles(),this.setHostedFieldContainerHeight(),window.addEventListener("load",this.setHostedFieldContainerHeight.bind(this))}},{key:"computedStyles",value:function(){var e=this,t=this.form.querySelector('input[name="card_name"]'),r=window.getComputedStyle(t,null);Array.from(this.styles.container).length||(this.hostedFieldContainerStyleProperties.forEach((function(t){e.styles.container=p(y({},t,r.getPropertyValue(t)),e.styles.container)})),this.hostedInputFieldStyleProperties.forEach((function(t){e.styles.input=p(y({},t,r.getPropertyValue(t)),e.styles.input)})),this.hostedInputFieldPlaceholderStyleProperties.forEach((function(t){e.styles["input:placeholder"]=p(y({},t,r.getPropertyValue(t)),e.styles["input:placeholder"])})))}},{key:"setHostedFieldContainerHeight",value:function(){if(this.styles.container.height="".concat(this.form.querySelector('input[name="card_name"]').offsetHeight,"px"),!["auto","0px"].includes(this.styles.container.height))for(var e in this.hostedCardFieldsContainers)this.hostedCardFieldsContainers[e].style.setProperty("height",this.styles.container.height)}},{key:"setFocusStyle",value:function(){var e=this;this.form.querySelectorAll('input[type="text"]').forEach((function(t){t.addEventListener("focus",(function(t){if(!Array.from(e.styles["input:focus"]).length){var r=window.getComputedStyle(t.target,null);e.hostedFocusedInputFieldStyleProperties.forEach((function(t){e.styles["input:focus"]=p(y({},t,r.getPropertyValue(t)),e.styles["input:focus"])}))}}),{once:!0})}))}},{key:"canThreeDsAuthorizeCard",value:function(e){return["NO","POSSIBLE"].includes(e.liabilityShift)}},{key:"IsCardThreeDsAuthorized",value:function(e){return e.liabilityShifted&&"POSSIBLE"===e.liabilityShift}},{key:"hostedFieldOnSubmitErrorHandler",value:function(e){var t={},r=[];if(!Object.values(e).length)throw Give.form.fn.resetDonationButton(this.jQueryForm),window.givePayPalCommerce.genericDonorErrorMessage;for(var n in e.details.forEach((function(e){if(e.hasOwnProperty("field")){if(!t.hasOwnProperty("".concat(e.field))){var n="";if(-1!==e.field.indexOf("expiry"))n=givePayPalCommerce.paypalCardInfoErrorPrefixes.expirationDateField;else if(-1!==e.field.indexOf("number"))n=givePayPalCommerce.paypalCardInfoErrorPrefixes.cardNumberField;else{if(-1===e.field.indexOf("security_code"))return e.hasOwnProperty("description")?void r.push({message:e.description}):void r.push({message:"".concat(givePayPalCommerce.genericDonorErrorMessage," ").concat(givePayPalCommerce.errorCodeLabel,": ").concat(e.issue)});n=givePayPalCommerce.paypalCardInfoErrorPrefixes.cardCvcField}t["".concat(e.field)]=n?["<strong>".concat(n,"</strong>")]:[]}t["".concat(e.field)].push("".concat(e.description,"."))}else r.push({message:e.description})})),t)r.push({message:t[n].join(" ")});Give.form.fn.addErrorsAndResetDonationButton(this.jQueryForm,Give.form.fn.getErrorHTML(r))}},{key:"submitDonationForm",value:function(){this.jQueryForm.off("submit"),this.jQueryForm.submit()}},{key:"toggleFields",value:function(){var e=C.isRecurringDonation(this.form)?"none":"block",t="none"===e&&!f.canShow(this.form);for(var r in this.toggleCardNameField(t),this.hostedCardFieldsContainers)this.hostedCardFieldsContainers[r].style.display=e,this.hostedCardFieldsContainers[r].parentElement.style.display=t?"none":"block";this.customCardFields.separator.style.display=t?"none":"flex"}},{key:"toggleCardNameField",value:function(e){var t=this.form.querySelector('input[name="card_name"]');t.parentElement.style.display=e?"none":"block",t.disabled=e}},{key:"getFieldTypeByFieldName",value:function(e){return"card_number"===e?"number":"card_cvc"===e?"cvv":"card_expiry"===e?"expirationDate":void 0}}],n=[{key:"canShow",value:function(){return!0===paypal.HostedFields.isEligible()&&!!window.givePayPalCommerce.supportsCustomPayments}}],r&&b(t.prototype,r),n&&b(t,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(i);const _=E;function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==j(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===j(i)?i:String(i)),n)}var o,i}var x=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"getFormDataWithoutGiveActionField",value:function(e){var t=new FormData(e);return t.delete("give_action"),t}},{key:"addFieldToForm",value:function(e,t,r){var n=document.createElement("input");return n.type="hidden",n.name=r,n.value=t,new Promise((function(t,r){t(e.appendChild(n))}))}},{key:"isPayPalCommerceSelected",value:function(e){return"paypal-commerce"===Give.form.fn.getGateway(e)}},{key:"addErrors",value:function(e,t){e.find("#give-paypal-commerce-smart-buttons-wrap").before(t)}},{key:"isRecurringDonation",value:function(e){var t=e.querySelector('input[name="_give_is_donation_recurring"]');return t&&"1"===t.value}},{key:"trackRecurringHiddenFieldChange",value:function(t,r){new window.MutationObserver((function(t){t[0].oldValue!==t[0].target.value&&e.isPayPalCommerceSelected(jQuery(t[0].target).closest(".give-form"))&&r.call()})).observe(t,{attributeFilter:["value"],attributeOldValue:!0})}},{key:"trackDonationCurrencyChange",value:function(t,r){new window.MutationObserver((function(t){t[0].oldValue!==t[0].target.getAttribute("data-currency_code")&&e.isPayPalCommerceSelected(jQuery(t[0].target))&&r.call()})).observe(t,{attributeFilter:["data-currency_code"],attributeOldValue:!0})}},{key:"toggleDonateNowButton",value:function(t){var r="";(!_.canShow()||e.isRecurringDonation(t)&&!f.canShow(t))&&(r="none"),t.querySelector('input[name="give-purchase"]').style.display=r}}],(r=null)&&O(t.prototype,r),n&&O(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();const C=x;function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function L(){L=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function s(e,t,r,o){var i=t&&t.prototype instanceof d?t:d,a=Object.create(i.prototype),c=new _(o||[]);return n(a,"_invoke",{value:P(e,r,c)}),a}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var f={};function d(){}function h(){}function p(){}var y={};u(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(j([])));m&&m!==t&&r.call(m,i)&&(y=m);var g=p.prototype=d.prototype=Object.create(y);function b(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function o(n,i,a,c){var u=l(e[n],e,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==k(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){o("next",e,a,c)}),(function(e){o("throw",e,a,c)})):t.resolve(f).then((function(e){s.value=e,a(s)}),(function(e){return o("throw",e,a,c)}))}c(u.arg)}var i;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){o(e,r,t,n)}))}return i=i?i.then(n,n):n()}})}function P(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return O()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=F(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=l(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function F(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,F(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=l(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,f;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function j(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=p,n(g,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:h,configurable:!0}),h.displayName=u(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,u(e,c,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(g),u(g,c,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=j,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:j(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function T(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function D(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){T(i,n,o,a,c,"next",e)}function c(e){T(i,n,o,a,c,"throw",e)}a(void 0)}))}}function G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function(e,t){if("object"!==k(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==k(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===k(i)?i:String(i)),n)}var o,i}function A(e,t){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},A(e,t)}function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=N(e);if(t){var o=N(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===k(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function N(e){return N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},N(e)}var I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A(e,t)}(s,e);var t,r,n,o,i,a,c,u=H(s);function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),u.apply(this,arguments)}return t=s,r=[{key:"setupProperties",value:function(){this.ccFieldsContainer=this.form.querySelector('[id^="give_cc_fields-"]'),this.recurringChoiceHiddenField=this.form.querySelector('input[name="_give_is_donation_recurring"]'),this.smartButton=null}},{key:"getButtonContainer",value:function(){this.ccFieldsContainer=this.form.querySelector('[id^="give_cc_fields-"]');var e=this.ccFieldsContainer.querySelector("#give-paypal-commerce-smart-buttons-wrap");if(e)return e;var t=document.createElement("div"),r=this.ccFieldsContainer.querySelector(".separator-with-text");t.setAttribute("id","give-paypal-commerce-smart-buttons-wrap");var n=this.ccFieldsContainer.querySelector("[id^=give-card-number-wrap-]");return this.ccFieldsContainer.insertBefore(t,r||n)}},{key:"renderPaymentMethodOption",value:function(){var e=this;this.smartButtonContainer=this.getButtonContainer(),this.smartButton&&this.smartButton.close();var t={onInit:this.onInitHandler.bind(this),onClick:this.onClickHandler.bind(this),createOrder:this.createOrderHandler.bind(this),onApprove:this.orderApproveHandler.bind(this),style:{layout:"vertical",size:"responsive",shape:"rect",label:"paypal",color:"gold",tagline:!1},onError:function(t){e.displayErrorMessage(t)}};return C.isRecurringDonation(this.form)&&(t.createSubscription=this.creatSubscriptionHandler.bind(this),t.onApprove=this.subscriptionApproveHandler.bind(this),delete t.createOrder),C.toggleDonateNowButton(this.form),this.smartButton=paypal.Buttons(t),this.smartButton.render(this.smartButtonContainer)}},{key:"onInitHandler",value:function(e,t){}},{key:"onClickHandler",value:(c=D(L().mark((function e(t,r){var n,o;return L().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FormData(this.form),_.canShow()&&(n.delete("card_name"),n.delete("card_cvc"),n.delete("card_number"),n.delete("card_expiry")),Give.form.fn.removeErrors(this.jQueryForm),e.next=5,Give.form.fn.isDonorFilledValidData(this.form,n);case 5:if("success"!==(o=e.sent)){e.next=8;break}return e.abrupt("return",r.resolve());case 8:return this.showError(o),e.abrupt("return",r.reject());case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"creatSubscriptionHandler",value:(a=D(L().mark((function e(t,r){var n,o;return L().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Give.form.fn.removeErrors(this.jQueryForm),e.next=3,fetch("".concat(this.ajaxurl,"?action=give_paypal_commerce_create_plan_id"),{method:"POST",body:C.getFormDataWithoutGiveActionField(this.form)});case 3:return n=e.sent,e.next=6,n.json();case 6:if((o=e.sent).success){e.next=9;break}throw o.data.error;case 9:return e.abrupt("return",r.subscription.create({plan_id:o.data.id}));case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"subscriptionApproveHandler",value:(i=D(L().mark((function e(t,r){return L().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Give.form.fn.showProcessingState(window.givePayPalCommerce.textForOverlayScreen),e.next=3,C.addFieldToForm(this.form,t.subscriptionID,"payPalSubscriptionId");case 3:this.submitDonationForm();case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"orderApproveHandler",value:(o=D(L().mark((function e(t,r){var n,o,i,a;return L().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Give.form.fn.showProcessingState(window.givePayPalCommerce.textForOverlayScreen),Give.form.fn.disable(this.jQueryForm,!0),Give.form.fn.removeErrors(this.jQueryForm),e.next=5,fetch("".concat(this.ajaxurl,"?action=give_paypal_commerce_approve_order&order=")+t.orderID,{method:"post",body:C.getFormDataWithoutGiveActionField(this.form)});case 5:return n=e.sent,e.next=8,n.json();case 8:if((o=e.sent).success){e.next=18;break}if(Give.form.fn.disable(this.jQueryForm,!1),Give.form.fn.hideProcessingState(),this.displayErrorMessage(o.data.error,!0),!(i=o.data.error.details[0])||"INSTRUMENT_DECLINED"!==i.issue){e.next=17;break}return e.abrupt("return",r.restart());case 17:return e.abrupt("return");case 18:return a=o.data.order,e.next=21,C.addFieldToForm(this.form,a.id,"payPalOrderId");case 21:this.submitDonationForm();case 22:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"submitDonationForm",value:function(){this.jQueryForm.off("submit"),this.removeCreditCardFields(),this.form.submit()}},{key:"removeCreditCardFields",value:function(){if(_.canShow()){this.jQueryForm.find('input[name="card_name"]').parent().remove(),this.ccFieldsContainer.querySelector(".separator-with-text").remove();var e=new f(this.form);for(var t in e.cardFields)e.cardFields[t].el.parentElement.remove()}}}],r&&G(t.prototype,r),n&&G(t,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(i);const R=I;var q=setTimeout;function B(e){return Boolean(e&&void 0!==e.length)}function Q(){}function M(e){if(!(this instanceof M))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],J(e,this)}function V(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,M._immediateFn((function(){var r=1===e._state?t.onFulfilled:t.onRejected;if(null!==r){var n;try{n=r(e._value)}catch(e){return void W(t.promise,e)}z(t.promise,n)}else(1===e._state?z:W)(t.promise,e._value)}))):e._deferreds.push(t)}function z(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var r=t.then;if(t instanceof M)return e._state=3,e._value=t,void Y(e);if("function"==typeof r)return void J((n=r,o=t,function(){n.apply(o,arguments)}),e)}e._state=1,e._value=t,Y(e)}catch(t){W(e,t)}var n,o}function W(e,t){e._state=2,e._value=t,Y(e)}function Y(e){2===e._state&&0===e._deferreds.length&&M._immediateFn((function(){e._handled||M._unhandledRejectionFn(e._value)}));for(var t=0,r=e._deferreds.length;t<r;t++)V(e,e._deferreds[t]);e._deferreds=null}function U(e,t,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=r}function J(e,t){var r=!1;try{e((function(e){r||(r=!0,z(t,e))}),(function(e){r||(r=!0,W(t,e))}))}catch(e){if(r)return;r=!0,W(t,e)}}function K(e){var t="";return Z(e,(function(r){0!==t.length&&(t+="&"),t+=r+"="+e[r]})),t}function X(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=document.createElement("script");return r.src=e,Z(t,(function(e){r.setAttribute(e,t[e])})),r}function Z(e,t){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r)}function $(e){var t=0;return Z(e,(function(){return t++})),t}M.prototype.catch=function(e){return this.then(null,e)},M.prototype.then=function(e,t){var r=new this.constructor(Q);return V(this,new U(e,t,r)),r},M.prototype.finally=function(e){var t=this.constructor;return this.then((function(r){return t.resolve(e()).then((function(){return r}))}),(function(r){return t.resolve(e()).then((function(){return t.reject(r)}))}))},M.all=function(e){return new M((function(t,r){if(!B(e))return r(new TypeError("Promise.all accepts an array"));var n=Array.prototype.slice.call(e);if(0===n.length)return t([]);var o=n.length;function i(e,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,(function(t){i(e,t)}),r)}n[e]=a,0==--o&&t(n)}catch(e){r(e)}}for(var a=0;a<n.length;a++)i(a,n[a])}))},M.allSettled=function(e){return new this((function(t,r){if(!e||void 0===e.length)return r(new TypeError(typeof e+" "+e+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var n=Array.prototype.slice.call(e);if(0===n.length)return t([]);var o=n.length;function i(e,r){if(r&&("object"==typeof r||"function"==typeof r)){var a=r.then;if("function"==typeof a)return void a.call(r,(function(t){i(e,t)}),(function(r){n[e]={status:"rejected",reason:r},0==--o&&t(n)}))}n[e]={status:"fulfilled",value:r},0==--o&&t(n)}for(var a=0;a<n.length;a++)i(a,n[a])}))},M.resolve=function(e){return e&&"object"==typeof e&&e.constructor===M?e:new M((function(t){t(e)}))},M.reject=function(e){return new M((function(t,r){r(e)}))},M.race=function(e){return new M((function(t,r){if(!B(e))return r(new TypeError("Promise.race accepts an array"));for(var n=0,o=e.length;n<o;n++)M.resolve(e[n]).then(t,r)}))},M._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){q(e,0)},M._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var ee,te=!1;function re(e){return te?ee:ee=new M((function(t,r){if("undefined"==typeof window)return t(null);var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={queryParams:{},dataAttributes:{}};Z(e,(function(r){"data-"===r.substring(0,5)?t.dataAttributes[r]=e[r]:t.queryParams[r]=e[r]}));var r=t.queryParams,n=t.dataAttributes;return{queryString:K(r),dataAttributes:n}}(e),o=n.queryString,i=n.dataAttributes,a="".concat("https://www.paypal.com/sdk/js","?").concat(o);if(function(e,t){var r=document.querySelector('script[src="'.concat(e,'"]'));if(!r)return null;var n=X(e,t);if($(r.dataset)!==$(n.dataset))return null;var o=!0;return Z(r.dataset,(function(e){r.dataset[e]!==n.dataset[e]&&(o=!1)})),o?r:null}(a,i)&&window.paypal)return t(window.paypal);te=!0,function(e){var t=e.url,r=e.dataAttributes,n=e.onSuccess,o=e.onError,i=X(t,r);i.onerror=o,i.onload=n,document.head.insertBefore(i,document.head.firstElementChild)}({url:a,dataAttributes:i,onSuccess:function(){return te=!1,window.paypal?t(window.paypal):r(new Error("The window.paypal global variable is not available."))},onError:function(){return te=!1,r(new Error('The script "'.concat(a,"\" didn't load correctly.")))}})}))}const ne=window.wp.i18n;function oe(e){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oe(e)}function ie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(r),!0).forEach((function(t){ce(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ie(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ce(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==oe(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==oe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===oe(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".give-form-wrap"),t=[];function r(){e.forEach((function(e){var t=e.querySelector(".give-form");C.isPayPalCommerceSelected(jQuery(t))&&function(e){var t=new R(e),r=new f(e);if(t.boot(),_.canShow()){var n=new _(r);return r.boot(),void n.boot()}r.removeFields()}(t)}))}function n(e){var t,n,o;(t=e,n={},o=C.isRecurringDonation(t),n.intent=o?"subscription":"capture",n.vault=!!o,n.currency=Give.form.fn.getInfo("currency_code",jQuery(t)),re(ae(ae({},givePayPalCommerce.payPalSdkQueryParameters),n))).then((function(){r()})).catch((function(){var t=jQuery(e);Give.form.fn.addErrors(t,Give.form.fn.getErrorHTML([{message:(0,ne.__)("A problem has occurred with the connection between this site and PayPal, preventing donations. Please contact site administrators if reloading the page does not fix the issue. This is usually the result of some JavaScript conflict on the page.","give")}])),Give.form.fn.disable(t,!0)}))}e.forEach((function(e){Give.form.fn.hasDonationForm(e)&&t.push(e)})),t.length&&(n((e=t)[0].querySelector(".give-form")),e.forEach((function(e){var t=e.querySelector(".give-form");!function(e){var t=e.querySelector('input[name="_give_is_donation_recurring"]');t&&C.trackRecurringHiddenFieldChange(t,(function(){n(e)}))}(t),function(e){C.trackDonationCurrencyChange(e,(function(){n(e)}))}(t),function(e){document.addEventListener("give_gateway_loaded",(function(){C.isPayPalCommerceSelected(jQuery(e))&&n(e)}))}(t)})),jQuery("form.give-form").on("submit",(function(e){return!C.isPayPalCommerceSelected(jQuery(undefined))||(e.preventDefault(),!1)})))}))})();